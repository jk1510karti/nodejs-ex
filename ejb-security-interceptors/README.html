<!DOCTYPE html><html><head><title>README</title><link href="http://static.jboss.org/ffe/0/www/vendor/redhat/documentation.css" rel="stylesheet"></link><link href="http://static.jboss.org/ffe/0/www/vendor/redhat/pygments.css" rel="stylesheet"></link></head><body>
<h1><a id="ejbsecurityinterceptors-use-interceptors-to-switch-identities-for-an-ejb-call" class="anchor" href="#ejbsecurityinterceptors-use-interceptors-to-switch-identities-for-an-ejb-call"><span class="anchor-icon"></span></a>ejb-security-interceptors: Use Interceptors to Switch Identities for an EJB Call</h1>

<p>Author: Darran Lofthouse<br/>
Level: Advanced<br/>
Technologies: EJB, Security<br/>
Summary: The <code>ejb-security-interceptors</code> quickstart demonstrates how to use client and server side interceptors to switch the identity for an EJB call.<br/>
Target Product: JBoss EAP<br/>
Source: <a href="https://github.com/jboss-developer/jboss-eap-quickstarts/">https://github.com/jboss-developer/jboss-eap-quickstarts/</a>  </p>

<h2><a id="what-is-it" class="anchor" href="#what-is-it"><span class="anchor-icon"></span></a>What is it?</h2>

<p>The <code>ejb-security-interceptors</code> quickstart demonstrates how to use client and server side interceptors to switch the identity for an EJB call in Red Hat JBoss Enterprise Application Platform.</p>

<p>By default, when you make a remote call to an EJB deployed to the application server, the connection to the server is authenticated and any request received over this connection is executed as the identity that authenticated the connection. This is true for both client-to-server and server-to-server calls. If you need to use different identities from the same client, you normally need to open multiple connections to the server so that each one is authenticated as a different identity.</p>

<p>Rather than open multiple client connections, this quickstart offers an alternative solution. The identity used to authenticate the connection is given permission to execute a request as a different user. This is achieved with the addition of the following three components: </p>

<ol>
<li>A client side interceptor to pass the requested identity to the remote server.</li>
<li>A server side interceptor to receive the identity and request that the call switches to that identity.</li>
<li>A JAAS LoginModule to decide if the user of the connection is allowed to execute requests as the specified identity.</li>
</ol>

<p>The quickstart then makes use of two EJBs, <code>SecuredEJB</code> and <code>IntermediateEJB</code>, to verify that the propagation and identity switching is correct and a <code>RemoteClient</code> standalone client. </p>

<h3><a id="securedejb" class="anchor" href="#securedejb"><span class="anchor-icon"></span></a>SecuredEJB</h3>

<p>The <code>SecuredEJB</code> has three methods: </p>
<div class="highlight"><pre><span class="n">String</span> <span class="nf">getSecurityInformation</span><span class="p">();</span>
<span class="n">boolean</span> <span class="nf">roleOneMethod</span><span class="p">();</span>
<span class="n">boolean</span> <span class="nf">roleTwoMethod</span><span class="p">();</span>
</pre></div>
<p>The first method can be called by all users that are created in this quickstart. The purpose of this method is to return a String containing the name of the Principal that called the EJB along with the user&rsquo;s authorized role information, for example:</p>
<div class="highlight"><pre>    <span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">ConnectionUser</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
</pre></div>
<p>The next two methods are annotated to require that the calling user is authorized for roles &lsquo;RoleOne&rsquo; and &lsquo;RoleTwo&rsquo; respectively.</p>

<h3><a id="intermediateejb" class="anchor" href="#intermediateejb"><span class="anchor-icon"></span></a>IntermediateEJB</h3>

<p>The <code>IntermediateEJB</code> contains a single method. Its purpose is to make use of a remote connection and invoke each of the methods on the <code>SecuredEJB</code>. A summary is then returned with the outcome of the calls.</p>

<h3><a id="remoteclient" class="anchor" href="#remoteclient"><span class="anchor-icon"></span></a>RemoteClient</h3>

<p>Finally there is the <code>RemoteClient</code> stand-alone client. The client makes calls using the identity of the established connection and also makes calls switching the identity to the different users.</p>

<p>In the real world, remote calls between servers in the servers-to-server scenario would truly be remote and separate. For the purpose of this quickstart, we make use of a loopback connection to the same server so we don&rsquo;t need two servers just to run the test.</p>

<h2><a id="note-on-ejb-client-interceptors" class="anchor" href="#note-on-ejb-client-interceptors"><span class="anchor-icon"></span></a>Note on EJB client interceptors</h2>

<p>JBoss EAP allows client side interceptors for EJB invocations. Such interceptors are expected to implement the <code>org.jboss.ejb.client.EJBClientInterceptor</code> interface. User applications can then plug in such interceptors in the &lsquo;EJBClientContext&rsquo; either programatically or through the ServiceLoader mechanism.</p>

<ul>
<li>The programmatic way involves calling the <code>org.jboss.ejb.client.EJBClientContext.registerInterceptor(int order, EJBClientInterceptor interceptor)</code> API and passing the &lsquo;order&rsquo; and the &lsquo;interceptor&rsquo; instance. The &lsquo;order&rsquo; is used to decide where exactly in the client interceptor chain, this &lsquo;interceptor&rsquo; is going to be placed.</li>
<li>The ServiceLoader mechanism is an alternate approach which involves creating a <code>META-INF/services/org.jboss.ejb.client.EJBClientInterceptor</code> file and placing/packaging it in the classpath of the client application. The rules for such a file are dictated by the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">Java ServiceLoader Mechanism</a>. This file is expected to contain in each separate line the fully qualified class name of the EJB client interceptor implementation, which is expected to be available in the classpath. EJB client interceptors added via the ServiceLoader mechanism are added to the end of the client interceptor chain, in the order they were found in the classpath.</li>
</ul>

<p>This quickstart uses the ServiceLoader mechanism for registering the EJB client interceptor and places the <code>META-INF/services/org.jboss.ejb.client.EJBClientInterceptor</code> in the classpath, with the following content:</p>
<div class="highlight"><pre>    <span class="err">#</span> <span class="n">EJB</span> <span class="n">client</span> <span class="n">interceptor</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">the</span> <span class="n">interceptor</span> <span class="n">chain</span> <span class="n">during</span> <span class="n">an</span> <span class="n">invocation</span>
    <span class="err">#</span> <span class="n">on</span> <span class="n">EJB</span><span class="p">.</span> <span class="n">If</span> <span class="n">these</span> <span class="n">interceptors</span> <span class="n">are</span> <span class="n">to</span> <span class="n">be</span> <span class="n">added</span> <span class="n">at</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">position</span><span class="p">,</span> <span class="n">other</span> <span class="n">than</span> <span class="n">last</span><span class="p">,</span> <span class="n">then</span> <span class="n">use</span> <span class="n">the</span>
    <span class="err">#</span> <span class="n">programmatic</span> <span class="n">API</span> <span class="n">in</span> <span class="n">the</span> <span class="n">application</span> <span class="n">to</span> <span class="k">register</span> <span class="n">it</span> <span class="n">explicitly</span> <span class="n">to</span> <span class="n">the</span> <span class="n">EJBClientContext</span>

    <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">ClientSecurityInterceptor</span>
</pre></div>
<h2><a id="system-requirements" class="anchor" href="#system-requirements"><span class="anchor-icon"></span></a>System requirements</h2>

<p>The application this project produces is designed to be run on Red Hat JBoss Enterprise Application Platform 7. </p>

<p>All you need to build this project is Java 8.0 (Java SDK 1.8) or later and Maven 3.1.1 or later. See <a href="https://github.com/jboss-developer/jboss-developer-shared-resources/blob/master/guides/CONFIGURE_MAVEN_JBOSS_EAP7.md#configure-maven-to-build-and-deploy-the-quickstarts">Configure Maven for JBoss EAP 7</a> to make sure you are configured correctly for testing the quickstarts.</p>

<h2><a id="prerequisites" class="anchor" href="#prerequisites"><span class="anchor-icon"></span></a>Prerequisites</h2>

<p>This quickstart uses the default standalone configuration plus the modifications described here.</p>

<p>It is recommended that you test this approach in a separate and clean environment before you attempt to port the changes in your own environment.</p>

<h2><a id="use-of-eap7home" class="anchor" href="#use-of-eap7home"><span class="anchor-icon"></span></a>Use of EAP7_HOME</h2>

<p>In the following instructions, replace <code>EAP7_HOME</code> with the actual path to your JBoss EAP installation. The installation path is described in detail here: <a href="https://github.com/jboss-developer/jboss-developer-shared-resources/blob/master/guides/USE_OF_EAP7_HOME.md#use-of-eap_home-and-jboss_home-variables">Use of EAP7_HOME and JBOSS_HOME Variables</a>.</p>

<h2><a id="add-the-application-users" class="anchor" href="#add-the-application-users"><span class="anchor-icon"></span></a>Add the Application Users</h2>

<p>This quickstart uses secured management interfaces and is built around the default <code>ApplicationRealm</code> as configured in the JBoss EAP distribution.  You must create the following application users to access the running application:</p>

<table><thead>
<tr>
<th align="left"><strong>UserName</strong></th>
<th align="left"><strong>Realm</strong></th>
<th align="left"><strong>Password</strong></th>
<th align="left"><strong>Roles</strong></th>
</tr>
</thead><tbody>
<tr>
<td align="left">ConnectionUser</td>
<td align="left">ApplicationRealm</td>
<td align="left">ConnectionPassword1!</td>
<td align="left">User</td>
</tr>
<tr>
<td align="left">AppUserOne</td>
<td align="left">ApplicationRealm</td>
<td align="left">AppPasswordOne1!</td>
<td align="left">User, RoleOne</td>
</tr>
<tr>
<td align="left">AppUserTwo</td>
<td align="left">ApplicationRealm</td>
<td align="left">AppPasswordTwo1!</td>
<td align="left">User, RoleTwo</td>
</tr>
<tr>
<td align="left">AppUserThree</td>
<td align="left">ApplicationRealm</td>
<td align="left">AppPasswordThree1!</td>
<td align="left">User, RoleOne, RoleTwo</td>
</tr>
</tbody></table>

<p>To add the users, open a command prompt and type the following commands:</p>
<div class="highlight"><pre>    <span class="n">For</span> <span class="n">Linux</span><span class="o">:</span>
      <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">ConnectionUser</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">ConnectionPassword1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="err">&#39;</span>
      <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserOne</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordOne1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleOne</span><span class="err">&#39;</span>
      <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserTwo</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordTwo1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleTwo</span><span class="err">&#39;</span> 
      <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserThree</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordThree1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleOne</span><span class="p">,</span><span class="n">RoleTwo</span><span class="err">&#39;</span>

    <span class="n">For</span> <span class="n">Windows</span><span class="o">:</span>
      <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">bat</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">ConnectionUser</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">ConnectionPassword1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="err">&#39;</span>
      <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">bat</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserOne</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordOne1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleOne</span><span class="err">&#39;</span>
      <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">bat</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserTwo</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordTwo1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleTwo</span><span class="err">&#39;</span> 
      <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">add</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">bat</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">u</span> <span class="err">&#39;</span><span class="n">AppUserThree</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="err">&#39;</span><span class="n">AppPasswordThree1</span><span class="o">!</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">g</span> <span class="err">&#39;</span><span class="n">User</span><span class="p">,</span><span class="n">RoleOne</span><span class="p">,</span><span class="n">RoleTwo</span><span class="err">&#39;</span>
</pre></div>
<p>The first user establishes the actual connection to the server. The subsequent two users demonstrate how to switch identities on demand. The final user can access everything but can not participate in identity switching.</p>

<p>Note that within the quickstart, we do not make use of the passwords for any of the &lsquo;App&rsquo; users. The passwords specified for those users are only suggested values that meet password minimum requirements.</p>

<p>If you prefer, you can use the add-user utility interactively. 
For an example of how to use the add-user utility, see the instructions located here: <a href="https://github.com/jboss-developer/jboss-developer-shared-resources/blob/master/guides/CREATE_USERS.md#add-an-application-user">Add an Application User</a>.</p>

<h2><a id="configure-the-jboss-eap-server" class="anchor" href="#configure-the-jboss-eap-server"><span class="anchor-icon"></span></a>Configure the JBoss EAP Server</h2>

<p>These steps assume you are running the server in standalone mode and using the default standalone.xml supplied with the distribution.</p>

<p>You configure the security domain by running JBoss CLI commands. For your convenience, this quickstart batches the commands into a <code>configure-security-domain.cli</code> script provided in the root directory of this quickstart. </p>

<ol>
<li><p>Before you begin, back up your server configuration file</p>

<ul>
<li>If it is running, stop the JBoss EAP server.</li>
<li>Backup the file: <code>EAP7_HOME/standalone/configuration/standalone.xml</code></li>
<li>After you have completed testing this quickstart, you can replace this file to restore the server to its original configuration.</li>
</ul></li>
<li><p>Start the JBoss EAP server by typing the following: </p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span>  <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">standalone</span><span class="p">.</span><span class="n">sh</span> 
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span>  <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">standalone</span><span class="p">.</span><span class="n">bat</span>
</pre></div></li>
<li><p>Review the <code>configure-security-domain.cli</code> file in the root of this quickstart directory. This script adds the <code>quickstart-domain</code> security domain to the <code>security</code> subsystem in the server configuration and configures authentication access. Comments in the script describe the purpose of each block of commands. </p></li>
<li><p>Open a new command prompt, navigate to the root directory of this quickstart, and run the following command, replacing EAP7_HOME with the path to your server:</p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">configure</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">domain</span><span class="p">.</span><span class="n">cli</span>
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">bat</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">configure</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">domain</span><span class="p">.</span><span class="n">cli</span>
</pre></div>
<p>You should see the following result when you run the script:</p>
<div class="highlight"><pre><span class="n">The</span> <span class="n">batch</span> <span class="n">executed</span> <span class="n">successfully</span>
<span class="p">{</span>
    <span class="s">&quot;outcome&quot;</span> <span class="o">=&gt;</span> <span class="s">&quot;success&quot;</span><span class="p">,</span>
    <span class="s">&quot;result&quot;</span> <span class="o">=&gt;</span> <span class="n">undefined</span>
<span class="p">}</span>
</pre></div></li>
<li><p>Because this example quickstart demonstrates security, exceptions are thrown when secured EJB access is attempted by an invalid user. If you want to review the security exceptions in the server log, you can skip this step. If you want to suppress these exceptions in the server log, run the following command, replacing EAP7_HOME with the path to your server:</p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">configure</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">exception</span><span class="p">.</span><span class="n">cli</span>
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">bat</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">configure</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">exception</span><span class="p">.</span><span class="n">cli</span>
</pre></div>
<p>You should see the following result when you run the script:</p>
<div class="highlight"><pre><span class="n">The</span> <span class="n">batch</span> <span class="n">executed</span> <span class="n">successfully</span>
<span class="p">{</span>
    <span class="s">&quot;outcome&quot;</span> <span class="o">=&gt;</span> <span class="s">&quot;success&quot;</span><span class="p">,</span>
    <span class="s">&quot;result&quot;</span> <span class="o">=&gt;</span> <span class="n">undefined</span>
<span class="p">}</span>
</pre></div></li>
<li><p>Stop the JBoss EAP server.</p></li>
</ol>

<h2><a id="review-the-modified-server-configuration" class="anchor" href="#review-the-modified-server-configuration"><span class="anchor-icon"></span></a>Review the Modified Server Configuration</h2>

<p>After stopping the server, open the <code>EAP7_HOME/standalone/configuration/standalone.xml</code> file and review the changes.</p>

<ol>
<li><p>The following <code>quickstart-domain</code> security-domain was added to the <code>security</code> subsystem.</p>
<div class="highlight"><pre><span class="nt">&lt;security-domain</span> <span class="na">name=</span><span class="s">&quot;quickstart-domain&quot;</span> <span class="na">cache-type=</span><span class="s">&quot;default&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;authentication&gt;</span>
        <span class="nt">&lt;login-module</span> <span class="na">name=</span><span class="s">&quot;DelegationLoginModule&quot;</span> <span class="na">code=</span><span class="s">&quot;org.jboss.as.quickstarts.ejb_security_interceptors.DelegationLoginModule&quot;</span> <span class="na">flag=</span><span class="s">&quot;optional&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;module-option</span> <span class="na">name=</span><span class="s">&quot;password-stacking&quot;</span> <span class="na">value=</span><span class="s">&quot;useFirstPass&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/login-module&gt;</span>
        <span class="nt">&lt;login-module</span> <span class="na">code=</span><span class="s">&quot;Remoting&quot;</span> <span class="na">flag=</span><span class="s">&quot;optional&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;module-option</span> <span class="na">name=</span><span class="s">&quot;password-stacking&quot;</span> <span class="na">value=</span><span class="s">&quot;useFirstPass&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/login-module&gt;</span>
        <span class="nt">&lt;login-module</span> <span class="na">code=</span><span class="s">&quot;RealmDirect&quot;</span> <span class="na">flag=</span><span class="s">&quot;required&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;module-option</span> <span class="na">name=</span><span class="s">&quot;password-stacking&quot;</span> <span class="na">value=</span><span class="s">&quot;useFirstPass&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/login-module&gt;</span>
    <span class="nt">&lt;/authentication&gt;</span>
<span class="nt">&lt;/security-domain&gt;</span>
</pre></div>
<p>The EJB side of this quickstart makes use of a new security domain called <code>quickstart-domain</code>, which delegates to the <code>ApplicationRealm</code>. The <code>DelegationLoginModule</code> is used to support identity switching in this quickstart.</p>

<p>The login module can either be added before or after the existing <code>Remoting</code> login module in the domain, but it MUST be somewhere before the existing <code>RealmDirect</code> login module. If the majority of requests will involve an identity switch, then it is recommended to have this module as the first module in the list. However, if the majority of requests will run as the connection user with occasional switches, it is recommended to place the <code>Remoting</code> login module first and this one second.</p>

<p>The login module loads the properties file <code>delegation-mapping.properties</code> from the deployment. The location of this properties file can be overridden with the module-option <code>delegationProperties</code>. At runtime, this login module is used to decide if the user of the connection to the server is allowed to execute the request as the specified user. </p>

<p>There are four ways the key can be specified in the properties file: </p>
<div class="highlight"><pre><span class="n">user</span><span class="err">@</span><span class="n">realm</span>  <span class="o">-</span> <span class="n">Exact</span> <span class="n">match</span> <span class="n">of</span> <span class="n">user</span> <span class="n">and</span> <span class="n">realm</span><span class="p">.</span>
<span class="n">user</span><span class="err">@</span><span class="o">*</span>      <span class="o">-</span> <span class="n">Allow</span> <span class="n">a</span> <span class="n">match</span> <span class="n">of</span> <span class="n">user</span> <span class="k">for</span> <span class="n">any</span> <span class="n">realm</span><span class="p">.</span>
<span class="o">*</span><span class="err">@</span><span class="n">realm</span>     <span class="o">-</span> <span class="n">Match</span> <span class="k">for</span> <span class="n">any</span> <span class="n">user</span> <span class="n">in</span> <span class="n">the</span> <span class="n">realm</span> <span class="n">specified</span><span class="p">.</span>
<span class="o">*</span>           <span class="o">-</span> <span class="n">Match</span> <span class="k">for</span> <span class="n">all</span> <span class="n">users</span> <span class="n">in</span> <span class="n">all</span> <span class="n">realms</span><span class="p">.</span>
</pre></div>
<p>When a request is received to switch the user, the identity of the user that opened the connection is used to check the properties file for an entry. The check is performed in the order listed above until the first match is found. Once a match is found, further entries that could match are not read. The value in the properties file can either be a wildcard <code>*</code> or it can be a comma separated list of users. Be aware that in the value/mapping side there is no notion of the realm. For this quickstart we use the following entry: </p>
<div class="highlight"><pre><span class="n">ConnectionUser</span><span class="err">@</span><span class="n">ApplicationRealm</span><span class="o">=</span><span class="n">AppUserOne</span><span class="p">,</span><span class="n">AppUserTwo</span>
</pre></div>
<p>This means that the ConnectionUser added above can only ask that a request is executed as either AppUserOne or AppUserTwo. It is not allowed to ask to be executed as AppUserThree.</p>

<p>All users are permitted to execute requests as themselves. In that case, the login module is not called. This is the default behavior that exists without the addition of the interceptors in this quickstart.</p>

<p>Taking this further, the <code>DelegationLoginModule</code> can be extended to provide custom delegation checks. One thing not currently checked is if the user being switched to actually exists. If the module is extended, the following method can be overridden to provide a custom check.</p>
<div class="highlight"><pre> <span class="n">protected</span> <span class="n">boolean</span> <span class="nf">delegationAcceptable</span><span class="p">(</span><span class="n">String</span> <span class="n">requestedUser</span><span class="p">,</span> <span class="n">OuterUserCredential</span> <span class="n">connectionUser</span><span class="p">);</span>
</pre></div>
<p>For the purpose of the quickstart we just need an outbound connection that loops back to the same server. This will be sufficient to demonstrate the server-to-server capabilities.</p></li>
<li><p>The following <code>ejb-outbound-realm</code> security-realm was added to the <code>management</code> security-realms. Note the Base64-encoded password is for the ConnectionUser account created above.</p>
<div class="highlight"><pre><span class="nt">&lt;security-realm</span> <span class="na">name=</span><span class="s">&quot;ejb-outbound-realm&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;server-identities&gt;</span>
        <span class="nt">&lt;secret</span> <span class="na">value=</span><span class="s">&quot;Q29ubmVjdGlvblBhc3N3b3JkMSE=&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/server-identities&gt;</span>
<span class="nt">&lt;/security-realm&gt;</span>
</pre></div></li>
<li><p>The following <code>ejb-outbound</code> outbound-socket-binding connection was created within the <code>standard-sockets</code> socket-binding-group: </p>
<div class="highlight"><pre><span class="nt">&lt;outbound-socket-binding</span> <span class="na">name=</span><span class="s">&quot;ejb-outbound&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;remote-destination</span> <span class="na">host=</span><span class="s">&quot;localhost&quot;</span> <span class="na">port=</span><span class="s">&quot;8080&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/outbound-socket-binding&gt;</span>
</pre></div></li>
<li><p>The following <code>ejb-outbound-connection</code> remote-outbound-connection was added to the outbound-connections within the <code>remoting</code> subsytem: </p>
<div class="highlight"><pre><span class="nt">&lt;outbound-connections&gt;</span>
    <span class="nt">&lt;remote-outbound-connection</span> <span class="na">name=</span><span class="s">&quot;ejb-outbound-connection&quot;</span> <span class="na">outbound-socket-binding-ref=</span><span class="s">&quot;ejb-outbound&quot;</span> <span class="na">security-realm=</span><span class="s">&quot;ejb-outbound-realm&quot;</span> <span class="na">username=</span><span class="s">&quot;ConnectionUser&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;properties&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;SSL_ENABLED&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;/remote-outbound-connection&gt;</span>
<span class="nt">&lt;/outbound-connections&gt;</span>
</pre></div></li>
<li><p>If you chose to run the script to suppress system exceptions, you should see the following configuration in the <code>ejb3</code> subsystem.</p>
<div class="highlight"><pre><span class="o">&lt;</span><span class="n">log</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">exceptions</span> <span class="n">value</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="o">/&gt;</span>
</pre></div></li>
</ol>

<h2><a id="start-the-jboss-eap-server-" class="anchor" href="#start-the-jboss-eap-server-"><span class="anchor-icon"></span></a>Start the JBoss EAP Server </h2>

<ol>
<li>Open a command prompt and navigate to the root of the JBoss EAP directory.</li>
<li><p>The following shows the command line to start the server:</p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span>   <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">standalone</span><span class="p">.</span><span class="n">sh</span>
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">standalone</span><span class="p">.</span><span class="n">bat</span>
</pre></div></li>
</ol>

<h2><a id="build-and-deploy-the-quickstart" class="anchor" href="#build-and-deploy-the-quickstart"><span class="anchor-icon"></span></a>Build and Deploy the Quickstart</h2>

<ol>
<li>Make sure you have started the JBoss EAP server as described above.</li>
<li>Open a command prompt and navigate to the root directory of this quickstart.</li>
<li><p>Type this command to build and deploy the archive:</p>
<div class="highlight"><pre><span class="n">mvn</span> <span class="n">clean</span> <span class="n">install</span> <span class="n">wildfly</span><span class="o">:</span><span class="n">deploy</span>
</pre></div></li>
<li><p>This will deploy <code>target/jboss-ejb-security-interceptors.jar</code> to the running instance of the server.</p></li>
</ol>

<h2><a id="run-the-client" class="anchor" href="#run-the-client"><span class="anchor-icon"></span></a>Run the client</h2>

<p>The step here assumes you have already successfully deployed the EJBs to the server in the previous step and that your command prompt is still in the same folder.</p>

<ol>
<li><p>Type this command to execute the client:</p>
<div class="highlight"><pre><span class="n">mvn</span> <span class="n">exec</span><span class="o">:</span><span class="n">exec</span>
</pre></div></li>
</ol>

<h2><a id="investigate-the-console-output" class="anchor" href="#investigate-the-console-output"><span class="anchor-icon"></span></a>Investigate the Console Output</h2>

<p>When you run the <code>mvn exec:exec</code> command, you see the following output. Note there may be other log messages interspersed between these. </p>
<div class="highlight"><pre><span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">ConnectionUser</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">ConnectionUser</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">ConnectionUser</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserOne</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserOne</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">true</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserOne</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">true</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserTwo</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserTwo</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">true</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserTwo</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">true</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserThree</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="n">Call</span> <span class="n">as</span> <span class="err">&#39;</span><span class="n">AppUserThree</span><span class="err">&#39;</span> <span class="n">correctly</span> <span class="n">rejected</span><span class="p">.</span>

<span class="n">This</span> <span class="n">second</span> <span class="n">round</span> <span class="n">of</span> <span class="n">tests</span> <span class="n">is</span> <span class="n">using</span> <span class="n">the</span> <span class="p">(</span><span class="n">PicketBox</span><span class="p">)</span> <span class="n">ClientLoginModule</span> <span class="n">with</span> <span class="n">LoginContext</span> <span class="n">API</span> <span class="n">to</span> <span class="n">set</span> <span class="n">the</span> <span class="n">desired</span> <span class="n">Principal</span><span class="p">.</span>

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">ConnectionUser</span> <span class="o">*</span> <span class="o">*</span>


<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">ConnectionUser</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">ConnectionUser</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserOne</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserOne</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">true</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserOne</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">true</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserTwo</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserTwo</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">false</span>
<span class="o">*</span> <span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">=</span><span class="nb">true</span>

<span class="o">*</span> <span class="n">Calling</span> <span class="n">the</span> <span class="n">IntermediateEJB</span> <span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">test</span> <span class="n">server</span> <span class="n">to</span> <span class="n">server</span> 

<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">Begin</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">=</span><span class="p">[</span><span class="n">Principal</span><span class="o">=</span><span class="p">{</span><span class="n">AppUserTwo</span><span class="p">},</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">User</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleOne</span><span class="p">}</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">In</span> <span class="n">role</span> <span class="p">{</span><span class="n">RoleTwo</span><span class="p">}</span><span class="o">=</span><span class="nb">true</span><span class="p">]</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleOneMethod</span><span class="o">=</span><span class="nb">false</span>
<span class="n">Can</span> <span class="n">call</span> <span class="n">roleTwoMethod</span><span class="o">=</span><span class="nb">true</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">IntermediateEJB</span> <span class="o">-</span> <span class="n">End</span> <span class="n">Testing</span> <span class="o">*</span> <span class="o">*</span> 
<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="o">*</span> <span class="o">*</span> <span class="n">About</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">test</span> <span class="n">as</span> <span class="n">AppUserThree</span> <span class="o">*</span> <span class="o">*</span>

<span class="o">*</span> <span class="n">Making</span> <span class="n">Direct</span> <span class="n">Calls</span> <span class="n">to</span> <span class="n">the</span> <span class="n">SecuredEJB</span>

<span class="o">*</span> <span class="o">*</span> <span class="n">Test</span> <span class="n">Complete</span> <span class="o">*</span> <span class="o">*</span> 

<span class="o">-------------------------------------------------</span>
<span class="n">Call</span> <span class="n">as</span> <span class="err">&#39;</span><span class="n">AppUserThree</span><span class="err">&#39;</span> <span class="n">correctly</span> <span class="n">rejected</span><span class="p">.</span>

<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
</pre></div>
<h2><a id="investigate-the-server-console-output" class="anchor" href="#investigate-the-server-console-output"><span class="anchor-icon"></span></a>Investigate the Server Console Output</h2>

<p>If you chose not to run the script to suppress system exceptions, you should see the following exceptions in the JBoss EAP server console or log. The exceptions are logged for each of the tests where a request is rejected because the user is not authorized. The stacktraces were removed from this text for readability.</p>
<div class="highlight"><pre><span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">9</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">9</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">String</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYSEC0027</span><span class="o">:</span> <span class="n">Invalid</span> <span class="n">User</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleTwoMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYEJB0364</span><span class="o">:</span> <span class="n">Invocation</span> <span class="n">on</span> <span class="n">method</span><span class="o">:</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">boolean</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">roleOneMethod</span><span class="p">()</span> <span class="n">of</span> <span class="n">bean</span><span class="o">:</span> <span class="n">SecuredEJB</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span>
<span class="p">...</span>
<span class="n">ERROR</span> <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">ejb3</span><span class="p">.</span><span class="n">invocation</span><span class="p">]</span> <span class="p">(</span><span class="n">EJB</span> <span class="k">default</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="n">WFLYEJB0034</span><span class="o">:</span> <span class="n">EJB</span> <span class="n">Invocation</span> <span class="n">failed</span> <span class="n">on</span> <span class="n">component</span> <span class="n">SecuredEJB</span> <span class="k">for</span> <span class="n">method</span> <span class="n">public</span> <span class="n">abstract</span> <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">String</span> <span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">quickstarts</span><span class="p">.</span><span class="n">ejb_security_interceptors</span><span class="p">.</span><span class="n">SecuredEJBRemote</span><span class="p">.</span><span class="n">getSecurityInformation</span><span class="p">()</span><span class="o">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">ejb</span><span class="p">.</span><span class="n">EJBAccessException</span><span class="o">:</span> <span class="n">WFLYSEC0027</span><span class="o">:</span> <span class="n">Invalid</span> <span class="n">User</span>
</pre></div>
<h2><a id="server-log-expected-warnings-and-errors" class="anchor" href="#server-log-expected-warnings-and-errors"><span class="anchor-icon"></span></a>Server Log: Expected warnings and errors</h2>

<p><em>Note:</em> You will see the following warning appear twice in the server log. You can ignore these warnings.</p>
<div class="highlight"><pre><span class="n">WARN</span>  <span class="p">[</span><span class="n">org</span><span class="p">.</span><span class="n">jboss</span><span class="p">.</span><span class="n">as</span><span class="p">.</span><span class="n">dependency</span><span class="p">.</span><span class="n">deprecated</span><span class="p">]</span> <span class="p">(</span><span class="n">MSC</span> <span class="n">service</span> <span class="kr">thread</span> <span class="mi">1</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="n">WFLYSRV0221</span><span class="o">:</span> <span class="n">Deployment</span> <span class="s">&quot;deployment.jboss-ejb-security-interceptors.jar&quot;</span> <span class="n">is</span> <span class="n">using</span> <span class="n">a</span> <span class="n">deprecated</span> <span class="n">module</span> <span class="p">(</span><span class="s">&quot;org.jboss.as.core-security-api:main&quot;</span><span class="p">)</span> <span class="n">which</span> <span class="n">may</span> <span class="n">be</span> <span class="n">removed</span> <span class="n">in</span> <span class="n">future</span> <span class="n">versions</span> <span class="n">without</span> <span class="n">notice</span><span class="p">.</span>
</pre></div>
<h2><a id="undeploy-the-archive" class="anchor" href="#undeploy-the-archive"><span class="anchor-icon"></span></a>Undeploy the Archive</h2>

<ol>
<li>Make sure you have started the JBoss EAP server as described above.</li>
<li>Open a command prompt and navigate to the root directory of this quickstart.</li>
<li><p>When you are finished testing, type this command to undeploy the archive:</p>
<div class="highlight"><pre><span class="n">mvn</span> <span class="n">wildfly</span><span class="o">:</span><span class="n">undeploy</span>
</pre></div></li>
</ol>

<h2><a id="remove-the-security-domain-configuration" class="anchor" href="#remove-the-security-domain-configuration"><span class="anchor-icon"></span></a>Remove the Security Domain Configuration</h2>

<p>You can remove the security domain configuration by running the  <code>remove-security-domain.cli</code> script provided in the root directory of this quickstart or by manually restoring the back-up copy the configuration file. </p>

<h3><a id="remove-the-security-domain-configuration-by-running-the-jboss-cli-script" class="anchor" href="#remove-the-security-domain-configuration-by-running-the-jboss-cli-script"><span class="anchor-icon"></span></a>Remove the Security Domain Configuration by Running the JBoss CLI Script</h3>

<ol>
<li><p>Start the JBoss EAP server by typing the following: </p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span>  <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">standalone</span><span class="p">.</span><span class="n">sh</span>
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span>  <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">standalone</span><span class="p">.</span><span class="n">bat</span>
</pre></div></li>
<li><p>Open a new command prompt, navigate to the root directory of this quickstart, and run the following command, replacing EAP7_HOME with the path to your server:</p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">remove</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">domain</span><span class="p">.</span><span class="n">cli</span> 
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">bat</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">remove</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">domain</span><span class="p">.</span><span class="n">cli</span> 
</pre></div>
<p>This script removes the <code>test</code> queue from the <code>messaging</code> subsystem in the server configuration. You should see the following result when you run the script:</p>
<div class="highlight"><pre><span class="n">The</span> <span class="n">batch</span> <span class="n">executed</span> <span class="n">successfully</span><span class="p">.</span>
<span class="p">{</span>
    <span class="s">&quot;outcome&quot;</span> <span class="o">=&gt;</span> <span class="s">&quot;success&quot;</span><span class="p">,</span>
    <span class="s">&quot;result&quot;</span> <span class="o">=&gt;</span> <span class="n">undefined</span>
<span class="p">}</span>
</pre></div></li>
<li><p>If you chose to run the script to suppress system exceptions, run the following command, replacing EAP7_HOME with the path to your server:</p>
<div class="highlight"><pre><span class="n">For</span> <span class="n">Linux</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">restore</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">exception</span><span class="p">.</span><span class="n">cli</span> 
<span class="n">For</span> <span class="n">Windows</span><span class="o">:</span> <span class="n">EAP7_HOME</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">jboss</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">bat</span> <span class="o">--</span><span class="n">connect</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">restore</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">exception</span><span class="p">.</span><span class="n">cli</span> 
</pre></div></li>
</ol>

<h3><a id="remove-the-security-domain-configuration-manually" class="anchor" href="#remove-the-security-domain-configuration-manually"><span class="anchor-icon"></span></a>Remove the Security Domain Configuration Manually</h3>

<ol>
<li>If it is running, stop the JBoss EAP server.</li>
<li>Replace the <code>EAP7_HOME/standalone/configuration/standalone.xml</code> file with the back-up copy of the file.</li>
</ol>

<h2><a id="run-the-quickstart-in-red-hat-jboss-developer-studio-or-eclipse" class="anchor" href="#run-the-quickstart-in-red-hat-jboss-developer-studio-or-eclipse"><span class="anchor-icon"></span></a>Run the Quickstart in Red Hat JBoss Developer Studio or Eclipse</h2>

<p>You can also start the server and deploy the quickstarts or run the Arquillian tests from Eclipse using JBoss tools. For general information about how to import a quickstart, add a JBoss EAP server, and build and deploy a quickstart, see <a href="https://github.com/jboss-developer/jboss-developer-shared-resources/blob/master/guides/USE_JBDS.md#use-jboss-developer-studio-or-eclipse-to-run-the-quickstarts">Use JBoss Developer Studio or Eclipse to Run the Quickstarts</a> </p>

<p>This quickstart requires additional configuration and deploys and runs differently in JBoss Developer Studio than the other quickstarts.</p>

<ol>
<li>Be sure to <a href="#add-the-application-users">Add the Application Users</a> as described above.</li>
<li>Follow the steps above to <a href="#configure-the-jboss-eap-server">Configure the JBoss EAP Server</a>. Stop the server at the end of that step.</li>
<li>To deploy the application to the JBoss EAP server, right-click on the <code>ejb-security-interceptors</code> project and choose <code>Run As</code> &ndash;> <code>Run on Server</code>.</li>
<li>To access the application, right-click on the <code>ejb-security-interceptors</code> project and choose <code>Run As</code> &ndash;> <code>Java Application</code>. </li>
<li>Choose &ldquo;RemoteClient - org.jboss.as.quickstarts.ejb_security_interceptors&rdquo; and click <code>OK</code>.</li>
<li>Review the output in the console window.</li>
<li>Be sure to <a href="#remove-the-security-domain-configuration">Remove the Security Domain Configuration</a> when you have completed testing this quickstart.</li>
</ol>

<h2><a id="debug-the-application" class="anchor" href="#debug-the-application"><span class="anchor-icon"></span></a>Debug the Application</h2>

<p>If you want to debug the source code of any library in the project, run the following command to pull the source into your local repository. The IDE should then detect it.</p>
<div class="highlight"><pre>    <span class="n">mvn</span> <span class="n">dependency</span><span class="o">:</span><span class="n">sources</span>
</pre></div></body></html>
